{"ast":null,"code":"var _jsxFileName = \"/home/local/esksami/AAA-Backup/School_N/FullStackPalautuksetHashtag2020/Osa7/bloglist-frontend/src/App.js\";\nimport React, { useState, useEffect } from 'react';\nimport Blog from './components/Blog';\nimport Notification from './components/Notification';\nimport Togglable from './components/Togglable';\nimport NewBlog from './components/NewBlog';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport storage from './utils/storage';\n\nconst App = () => {\n  const [blogs, setBlogs] = useState([]);\n  const [user, setUser] = useState(null);\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [notification, setNotification] = useState(null);\n  const blogFormRef = React.createRef();\n  useEffect(() => {\n    blogService.getAll().then(blogs => setBlogs(blogs));\n  }, []);\n  useEffect(() => {\n    const user = storage.loadUser();\n    setUser(user);\n  }, []);\n\n  const notifyWith = (message, type = 'success') => {\n    setNotification({\n      message,\n      type\n    });\n    setTimeout(() => {\n      setNotification(null);\n    }, 5000);\n  };\n\n  const handleLogin = async event => {\n    event.preventDefault();\n\n    try {\n      const user = await loginService.login({\n        username,\n        password\n      });\n      console.log(user);\n      setUsername('');\n      setPassword('');\n      setUser(user);\n      notifyWith(`${user.name} welcome back!`);\n      storage.saveUser(user);\n    } catch (exception) {\n      notifyWith('wrong username/password', 'error');\n    }\n  };\n\n  const createBlog = async blog => {\n    try {\n      const newBlog = await blogService.create(blog);\n      blogFormRef.current.toggleVisibility();\n      setBlogs(blogs.concat(newBlog));\n      notifyWith(`a new blog '${newBlog.title}' by ${newBlog.author} added!`);\n    } catch (exception) {\n      console.log(exception);\n    }\n  };\n\n  const handleLike = async id => {\n    const blogToLike = blogs.find(b => b.id === id);\n    const likedBlog = { ...blogToLike,\n      likes: blogToLike.likes + 1,\n      user: blogToLike.user.id\n    };\n    await blogService.update(likedBlog);\n    setBlogs(blogs.map(b => b.id === id ? { ...blogToLike,\n      likes: blogToLike.likes + 1\n    } : b));\n  };\n\n  const handleRemove = async id => {\n    const blogToRemove = blogs.find(b => b.id === id);\n    const ok = window.confirm(`Remove blog ${blogToRemove.title} by ${blogToRemove.author}`);\n\n    if (ok) {\n      await blogService.remove(id);\n      setBlogs(blogs.filter(b => b.id !== id));\n    }\n  };\n\n  const handleLogout = () => {\n    setUser(null);\n    storage.logoutUser();\n  };\n\n  if (!user) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }\n    }, \"login to application\"), /*#__PURE__*/React.createElement(Notification, {\n      notification: notification,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: handleLogin,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 11\n      }\n    }, \"username\", /*#__PURE__*/React.createElement(\"input\", {\n      id: \"username\",\n      value: username,\n      onChange: ({\n        target\n      }) => setUsername(target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 11\n      }\n    }, \"password\", /*#__PURE__*/React.createElement(\"input\", {\n      id: \"password\",\n      value: password,\n      onChange: ({\n        target\n      }) => setPassword(target.value),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 11\n      }\n    }, \"login\")));\n  }\n\n  const byLikes = (b1, b2) => b2.likes - b1.likes;\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }\n  }, \"blogs\"), /*#__PURE__*/React.createElement(Notification, {\n    notification: notification,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }\n  }, user.name, \" logged in \", /*#__PURE__*/React.createElement(\"button\", {\n    onClick: handleLogout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 31\n    }\n  }, \"logout\")), /*#__PURE__*/React.createElement(Togglable, {\n    buttonLabel: \"create new blog\",\n    ref: blogFormRef,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(NewBlog, {\n    createBlog: createBlog,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }\n  })), blogs.sort(byLikes).map(blog => {\n    console.log('blog', blog);\n    console.log('user', user);\n    return /*#__PURE__*/React.createElement(Blog, {\n      key: blog.id,\n      blog: blog,\n      handleLike: handleLike,\n      handleRemove: handleRemove,\n      own: user.username === (blog.user && blog.user.username),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }\n    });\n  }));\n};\n\nexport default App;","map":{"version":3,"sources":["/home/local/esksami/AAA-Backup/School_N/FullStackPalautuksetHashtag2020/Osa7/bloglist-frontend/src/App.js"],"names":["React","useState","useEffect","Blog","Notification","Togglable","NewBlog","blogService","loginService","storage","App","blogs","setBlogs","user","setUser","username","setUsername","password","setPassword","notification","setNotification","blogFormRef","createRef","getAll","then","loadUser","notifyWith","message","type","setTimeout","handleLogin","event","preventDefault","login","console","log","name","saveUser","exception","createBlog","blog","newBlog","create","current","toggleVisibility","concat","title","author","handleLike","id","blogToLike","find","b","likedBlog","likes","update","map","handleRemove","blogToRemove","ok","window","confirm","remove","filter","handleLogout","logoutUser","target","value","byLikes","b1","b2","sort"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Blog from './components/Blog'\nimport Notification from './components/Notification'\nimport Togglable from './components/Togglable'\nimport NewBlog from './components/NewBlog'\n\nimport blogService from './services/blogs'\nimport loginService from './services/login'\nimport storage from './utils/storage'\n\nconst App = () => {\n  const [blogs, setBlogs] = useState([])\n  const [user, setUser] = useState(null)\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n  const [notification, setNotification] = useState(null)\n\n  const blogFormRef = React.createRef()\n\n  useEffect(() => {\n    blogService.getAll().then(blogs =>\n      setBlogs(blogs)\n    )\n  }, [])\n\n  useEffect(() => {\n    const user = storage.loadUser()\n    setUser(user)\n  }, [])\n\n  const notifyWith = (message, type='success') => {\n    setNotification({\n      message, type\n    })\n    setTimeout(() => {\n      setNotification(null)\n    }, 5000)\n  }\n\n  const handleLogin = async (event) => {\n    event.preventDefault()\n\n    try {\n      const user = await loginService.login({\n        username, password\n      })\n\n      console.log(user)\n\n      setUsername('')\n      setPassword('')\n      setUser(user)\n      notifyWith(`${user.name} welcome back!`)\n      storage.saveUser(user)\n    } catch(exception) {\n      notifyWith('wrong username/password', 'error')\n    }\n  }\n\n  const createBlog = async (blog) => {\n    try {\n      const newBlog = await blogService.create(blog)\n      blogFormRef.current.toggleVisibility()\n      setBlogs(blogs.concat(newBlog))\n      notifyWith(`a new blog '${newBlog.title}' by ${newBlog.author} added!`)\n    } catch(exception) {\n      console.log(exception)\n    }\n  }\n\n  const handleLike = async (id) => {\n    const blogToLike = blogs.find(b => b.id === id)\n    const likedBlog = { ...blogToLike, likes: blogToLike.likes + 1, user: blogToLike.user.id }\n    await blogService.update(likedBlog)\n    setBlogs(blogs.map(b => b.id === id ?  { ...blogToLike, likes: blogToLike.likes + 1 } : b))\n  }\n\n  const handleRemove = async (id) => {\n    const blogToRemove = blogs.find(b => b.id === id)\n    const ok = window.confirm(`Remove blog ${blogToRemove.title} by ${blogToRemove.author}`)\n    if (ok) {\n      await blogService.remove(id)\n      setBlogs(blogs.filter(b => b.id !== id))\n    }\n  }\n\n  const handleLogout = () => {\n    setUser(null)\n    storage.logoutUser()\n  }\n\n  if ( !user ) {\n    return (\n      <div>\n        <h2>login to application</h2>\n\n        <Notification notification={notification} />\n\n        <form onSubmit={handleLogin}>\n          <div>\n            username\n            <input\n              id='username'\n              value={username}\n              onChange={({ target }) => setUsername(target.value)}\n            />\n          </div>\n          <div>\n            password\n            <input\n              id='password'\n              value={password}\n              onChange={({ target }) => setPassword(target.value)}\n            />\n          </div>\n          <button id='login'>login</button>\n        </form>\n      </div>\n    )\n  }\n\n  const byLikes = (b1, b2) => b2.likes - b1.likes\n\n  return (\n    <div>\n      <h2>blogs</h2>\n\n      <Notification notification={notification} />\n\n      <p>\n        {user.name} logged in <button onClick={handleLogout}>logout</button>\n      </p>\n\n      <Togglable buttonLabel='create new blog'  ref={blogFormRef}>\n        <NewBlog createBlog={createBlog} />\n      </Togglable>\n\n      {blogs.sort(byLikes).map(blog => {\n        console.log('blog', blog)\n        console.log('user', user)\n        return (<Blog\n          key={blog.id}\n          blog={blog}\n          handleLike={handleLike}\n          handleRemove={handleRemove}\n          own={user.username===(blog.user && blog.user.username)}\n        />)}\n      )}\n    </div>\n  )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}